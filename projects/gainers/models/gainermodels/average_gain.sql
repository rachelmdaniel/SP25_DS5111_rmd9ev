{{ config(materialized='table') }}

WITH combined_data AS (
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.WSJGAINERS_NORM_20250325_163817
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.WSJGAINERS_NORM_20250325_202638
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.WSJGAINERS_NORM_20250326_170820
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.WSJGAINERS_NORM_20250326_203022
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.WSJGAINERS_NORM_20250327_133155
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.WSJGAINERS_NORM_20250327_163048
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.WSJGAINERS_NORM_20250327_200143
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.WSJGAINERS_NORM_20250328_133150
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.WSJGAINERS_NORM_20250328_200202
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.WSJGAINERS_NORM_20250402_163039
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.WSJGAINERS_NORM_20250402_200147
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.YGAINERS_NORM_20250325_163027
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.YGAINERS_NORM_20250325_202638
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.YGAINERS_NORM_20250326_133135
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.YGAINERS_NORM_20250326_163023
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.YGAINERS_NORM_20250326_200138
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.YGAINERS_NORM_20250327_133152
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.YGAINERS_NORM_20250327_163041
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.YGAINERS_NORM_20250327_200137
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.YGAINERS_NORM_20250328_133144
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.YGAINERS_NORM_20250328_163035
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.YGAINERS_NORM_20250328_200202
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.YGAINERS_NORM_20250402_133132
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.YGAINERS_NORM_20250402_163037
    UNION ALL
    SELECT symbol, price_percent_change FROM DATA_SCIENCE.RMD9EV_RAW.YGAINERS_NORM_20250402_200142
)

SELECT
    symbol,
    AVG(price_percent_change) AS avg_price_percent_change
FROM combined_data
GROUP BY symbol
